<!DOCTYPE html> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <title>Ryan Aghdam: A Rookie Mistake: ryanaghdam.com Re-written</title> <link href="https://fonts.googleapis.com/css?family=Cardo|Oswald" rel="stylesheet"> <link rel="stylesheet" type="text/css" href="/assets/styles.css"> <!--[if IE]><link rel="shortcut icon" href="/assets/favicon.ico"><![endif]--> <link rel="icon" href="/assets/favicon.png"> <header> <h1>Ryan Aghdam</h1> <nav> <ul> <li><a href="/">All Posts</a></li> <li><a href="/projects">Projects</a></li> <li><a href="/rss.xml">Subscribe</a></li> </ul> </nav> </header> <main><article> <header> <h1>A Rookie Mistake: ryanaghdam.com Re-written</h1> <p> <time datetime="2015-08-23" pubdate> August 23, 2015 </time> </p> </header> <p>Frustrated with building my website with <a href="http://jekyllrb.com/">Jekyll</a> and <a href="http://liquidmarkup.org/">Liquid Templates</a>, I decided that I could write myself something to take its place. I ignored the many available solutions and started thinking of waht I wanted in a blogging platform.</p> <ol> <li> <p>I wanted to store posts as plain markdown files. A web interface was not only unnecessary but unwanted.</p> </li> <li> <p>Since I was writing it myself, I wanted to use node.js and try out some modules: <a href="http://ramdajs.com/">Ramda</a>, <a href="https://github.com/thlorenz/proxyquire">proxyquire</a>, and <a href="https://github.com/substack/tape">tape</a>.</p> </li> <li> <p>I wanted the content to be completely separate from the presentation layer and easily portable, for when I inevitably want to spent a weekend re-writing code rather than content.</p> </li> <li> <p>I wanted to continue to use the <a href="http://lokeshdhakar.com/projects/lightbox2/">Lightbox</a> plugin. I was unhappy that I was using a <a href="https://github.com/ryanaghdam/ryanaghdam.github.io/blob/3463115dc787445aef90bf544c7f647b1b730d59/_includes/image.html">Liquid template include</a> to insert images. I wanted to be able to just include an image using the traditional Markdown syntax.</p> </li> <li> <p>I also wanted to run the site with very minimal cost.</p> </li> </ol> <p>Half a Saturday and most of a Sunday later, let’s see what I have.</p> <h2 id="content-package">Content Package</h2> <p>A package, <a href="https://www.npmjs.com/package/ryanaghdam-content"><code class="highlighter-rouge">ryanaghdam-content</code></a>, provides an API to read all posts, read one post (matching by slug), or all posts from a given category.</p> <p>A <a href="https://github.com/ryanaghdam/ryanaghdam-content/blob/v1.0.1/scripts/resize-images.sh">script</a> runs during install time to resize the source images using ImageMagick.</p> <p>The images are <a href="https://github.com/ryanaghdam/ryanaghdam-homepage/blob/v1.2.0/index.js#L13-L15">surfaced on the presentation layer</a>, using <a href="http://expressjs.com/starter/static-files.html">Express’s static file middleware</a>.</p> <p>Most functions are memoized so that filesystem access is cached. For the most part, this package adheres to basic functional programming practices; most functions are <a href="https://en.wikipedia.org/wiki/Pure_function">pure</a>.</p> <h2 id="the-presentation-layer">The Presentation layer</h2> <p>The front end is a simple Express application, <a href="https://github.com/ryanaghdam/ryanaghdam-homepage"><code class="highlighter-rouge">ryanaghdam-homepage</code></a>.</p> <p>Controllers access the API exposed by the <code class="highlighter-rouge">ryanaghdam-content</code> package and render <a href="http://jade-lang.com/">Jade</a> templates.</p> <p>A <a href="https://github.com/ryanaghdam/ryanaghdam-homepage/blob/v1.2.0/services/content.js#L7-L28">content service</a> is used to slightly transform data before it’s sent off to Jade. This could have – and possibly should have – been done in the content package. I chose to do the transformation here, because I want to use it as an example for how something at work can be done.</p> <p>Unlike <code class="highlighter-rouge">ryanaghdam-content</code>, the Express application is not covered by tests. I plan on using <a href="http://nightwatchjs.org/">Nightwatch</a> or <a href="https://github.com/paypal/nemo">Nemo</a>.</p> <h2 id="the-aftermath">The Aftermath</h2> <p>I mentioned a few goals that I wanted to accomplish.</p> <ol> <li> <p>Store content in plain markdown files – success. All content is plain markdown with YAML front matter. It’s easily portable for when I next change my mind.</p> </li> <li> <p>Use Ramda, proxyquire, and tape – success.</p> </li> <li> <p>Separate the content from the presentation layer – success. The content is a separate, published npm package. A completely different presentation layer can use the same content. There is, however, a problem with this approach. To make a content change, I must: update and publish the content package, update <a href="https://github.com/ryanaghdam/ryanaghdam-homepage"><code class="highlighter-rouge">ryanaghdam-homepage</code></a> to use the latest version of the content package, and then deploy to Heroku. Previously, with my Jekyll-based setup, I just had to push my content to GitHub. <a href="https://travis-ci.org/">Travis-CI</a> would automatically run to build and deploy (to <a href="https://pages.github.com/">GitHub Pages</a>).</p> </li> <li> <p>Use Lightbox with plain Markdown – success. I am using <a href="https://github.com/markdown-it/markdown-it">markdown-it</a> to render Markdown. It features a plugin interface, which enabled me to write a custom plugin that changed the way images are rendered. It’s pretty <a href="https://github.com/ryanaghdam/ryanaghdam-content/blob/master/lib/domain.js#L3-L34">poorly written</a>.</p> </li> <li> <p>Minimal runnings costs – TBD. I am currently using a free-tier <a href="http://heroku.com/">Heroku</a> instance. Time will tell if that’s a viable solution.</p> </li> </ol> <p>Not too bad when looking at just the goals. But is it any better? I have a more complex deployment process, a more complex hosting environment, and a website that, to the user, hasn’t changed a bit.</p> <p>I got to spend some time working on a project that uses some modules and architecture that I wanted to try. Is the product – my website – noticeably improved, or even different?</p> <p>I think this is a common rookie-mistake – rewriting something just to use new technology and certainly something I should have been more cognizant of. If it were a professional project, rather than a rainy weekend project, it would have been an tremendous waste of time and effort.</p> <p>It’s a good thing that I enjoy writing things that nobody reads – these blog posts and software – otherwise this weekend would have been a waste.</p> </article> </main> <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create', 'UA-7132219-2', 'auto');ga('send', 'pageview');</script> <script src="/assets/lightbox2-master/dist/js/lightbox-plus-jquery.min.js"></script>